#!/usr/bin/env ruby

require 'trollop'

Dir[File.join(File.dirname(__FILE__), '..', 'lib', '*.rb')].each do |file|
  require file
end

opts = Trollop::options do
  opt :input,  "input file (default: STDIN)", :type => :string
  opt :output, "output directory (default: pwd)", :type => :string
  opt :graphs, "generate graphs", :default => true
  opt :csv, "generate CSV", :default => false
end

input_file = opts[:input] || STDIN
output_dir = opts[:output] || Dir.pwd

pwd_stats = PwdumpAnalysis::Stats.new(input_file, output_dir)

pwd_stats.print_stats
pwd_stats.generate_graphs if opts[:graphs]
pwd_stats.generate_csv    if opts[:csv]
